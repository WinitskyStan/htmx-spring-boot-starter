# HTMX Documentation

## Using hx-indicator for Loading Spinners

The `hx-indicator` attribute allows you to show/hide a loading spinner or any other element during HTMX requests.

### How It Works

HTMX provides built-in CSS classes for indicators:
- `htmx-indicator` class - Marks elements that should be shown/hidden during requests
- `htmx-request` class - HTMX applies this class during a request

**Important:** By default, HTMX uses `opacity` to hide/show indicators. This means indicators take up space even when hidden (opacity: 0). We override this with `display: none/inline-block` to prevent spinners from taking up space and making buttons grow.

### Best Practice: Spinner in Button with Bootstrap

When placing a spinner inside a button (recommended for better UX), use `display: none/inline-block` to prevent the button from growing when the spinner is hidden:

```html
<!-- In your CSS -->
<style>
    .htmx-indicator {
        display: none;
    }

    .htmx-indicator.htmx-request {
        display: inline-block;
    }
</style>

<!-- In your HTML -->
<button type="button"
        class="btn btn-primary"
        hx-post="/endpoint"
        hx-target="#result"
        hx-swap="outerHTML"
        hx-indicator=".submit-spinner">
    <span class="spinner-border spinner-border-sm me-2 htmx-indicator submit-spinner" aria-hidden="true"></span>
    <span>Submit</span>
</button>
```

**Key points:**
- The spinner is completely hidden by default (`display: none`) so it takes up no space
- When HTMX makes a request, it adds the `htmx-request` class, making the spinner visible
- The margin (`me-2`) adds spacing between the spinner and text when visible
- Bootstrap's `.spinner-border` provides the visual styling

### Basic Implementation (Separate Spinner)

If you prefer a spinner outside the button:

1. **Create your spinner element** and add the `htmx-indicator` class:
```html
<div class="loading-spinner htmx-indicator"></div>
```

2. **Add CSS for your spinner design**:
```css
.loading-spinner {
    width: 24px;
    height: 24px;
    border: 3px solid rgba(37, 99, 235, 0.2);
    border-top: 3px solid #2563eb;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    display: none;
}

.loading-spinner.htmx-request {
    display: inline-block;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}
```

3. **Link the spinner to your button**:
```html
<button hx-post="/endpoint"
        hx-target="#result"
        hx-swap="outerHTML"
        hx-indicator=".loading-spinner">
    Submit
</button>
<div class="loading-spinner htmx-indicator"></div>
```

### CSS Selectors for hx-indicator

Use either **class selectors** or **ID selectors** depending on your needs:

**Class selector** (recommended for reusable spinners):
```html
hx-indicator=".submit-spinner"
```

**ID selector** (when you need a specific spinner):
```html
hx-indicator="#submit-spinner"
```

### How It Works Under the Hood

When you click a button with `hx-indicator=".submit-spinner"`:

1. HTMX finds the element matching the selector
2. During the request, HTMX adds the `htmx-request` class to that element
3. Your CSS rule `.htmx-indicator.htmx-request { display: inline-block; }` makes it visible
4. When the request completes, the `htmx-request` class is removed
5. The spinner hides again automatically (back to `display: none`)

### CSS Override: Why display: none Instead of Opacity

By default, HTMX's built-in CSS uses this pattern:
```css
/* HTMX default behavior */
.htmx-indicator { opacity: 0; }
.htmx-request .htmx-indicator { opacity: 1; }
```

This approach hides indicators with opacity but they still occupy space in the DOM, making buttons grow when spinners are inside them.

**Our override** uses `display` instead:
```css
/* Our custom override */
.htmx-indicator { display: none; }
.htmx-indicator.htmx-request { display: inline-block; }
```

This completely removes the element from the document flow when hidden, preventing buttons from changing size. When HTMX adds the `htmx-request` class, we show it as `inline-block` so it appears next to the button text without wrapping.

### Using Bootstrap Spinners

This project uses Bootstrap's spinner components with HTMX:

```html
<!-- In your template head -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- In your CSS -->
<style>
    .htmx-indicator {
        display: none;
    }

    .htmx-indicator.htmx-request {
        display: inline-block;
    }
</style>

<!-- In your form -->
<button type="button"
        class="btn btn-primary"
        hx-post="/userform/submit"
        hx-target="#form-section"
        hx-swap="outerHTML"
        hx-indicator=".submit-spinner">
    <span class="spinner-border spinner-border-sm me-2 htmx-indicator submit-spinner" aria-hidden="true"></span>
    <span>Submit Form</span>
</button>
```

Bootstrap classes used:
- `.btn .btn-primary` - Styled button
- `.spinner-border` - Bootstrap's spinner animation
- `.spinner-border-sm` - Small size suitable for buttons
- `.me-2` - Margin-end spacing between spinner and text
- `aria-hidden="true"` - Hide decorative spinner from screen readers

### Multiple Spinners

You can have multiple spinners with the same class:

```html
<button hx-post="/submit" hx-indicator=".submit-spinner">
    <span class="spinner-border spinner-border-sm me-2 htmx-indicator submit-spinner"></span>
    Submit
</button>

<button hx-post="/delete" hx-indicator=".delete-spinner">
    <span class="spinner-border spinner-border-sm me-2 htmx-indicator delete-spinner"></span>
    Delete
</button>
```

Each button has its own unique spinner class to show/hide independently.

### Validation with Bootstrap

Bootstrap's form validation classes work seamlessly with HTMX:

```html
<div class="mb-3">
    <label for="email" class="form-label">Email *</label>
    <input type="email"
           id="email"
           class="form-control"
           th:classappend="${#fields.hasErrors('email')} ? 'is-invalid' : ''"
           th:field="*{email}">
    <div th:if="${#fields.hasErrors('email')}"
         th:errors="*{email}"
         class="invalid-feedback">
    </div>
</div>
```

Bootstrap classes:
- `.form-control` - Input styling
- `.is-invalid` - Red border for error states
- `.invalid-feedback` - Error message styling
